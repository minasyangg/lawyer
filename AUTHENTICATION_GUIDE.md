# Система Аутентификации и Управления Пользователями

## Обзор функционала

Система предоставляет полноценную аутентификацию с ролевым доступом и возможностью двухфакторной аутентификации.

## Роли пользователей

- **ADMIN** - Полный доступ ко всем функциям, управление пользователями
- **EDITOR** - Редактирование контента, но без управления пользователями
- **USER** - Базовый доступ к контенту

## Как использовать

### 1. Вход в систему
- Перейдите на `/admin/login`
- Введите email и пароль
- По умолчанию админ: `admin@lawyer-site.com` / `admin123`

### 2. Управление пользователями (только ADMIN)
- Перейдите в `/admin/users`
- **Создание пользователя:**
  - Нажмите "Add User"
  - Заполните: имя, email, пароль, роль
  - Пароль будет автоматически зашифрован
- **Редактирование пользователя:**
  - Нажмите "Edit" у пользователя
  - Можно изменить имя, email, роль (но не пароль)
- **Удаление пользователя:**
  - Нажмите "Delete" у пользователя

### 3. Доступные роли в селекторе
- **User** - обычный пользователь (USER)
- **Editor** - редактор контента (EDITOR)  
- **Admin** - администратор (ADMIN)

## Безопасность

- Пароли шифруются с помощью bcrypt
- JWT токены для сессий
- Middleware проверяет права доступа
- Система логирования входов (готова к использованию)

## Тестирование

1. **Создайте тестового пользователя:**
   - Имя: Test User
   - Email: test@example.com
   - Пароль: test123
   - Роль: User

2. **Выйдите из админки и войдите под тестовым пользователем**

3. **Проверьте разные уровни доступа для разных ролей**

## Структура базы данных

```prisma
model User {
  id                Int          @id @default(autoincrement())
  name              String
  email             String       @unique
  password          String
  role              UserRole     @default(USER)
  status            UserStatus   @default(ACTIVE)
  emailVerified     Boolean      @default(false)
  
  // 2FA поля (готовы к использованию)
  twoFactorEnabled  Boolean      @default(false)
  twoFactorSecret   String?
  backupCodes       String[]     @default([])
  
  createdAt         DateTime     @default(now())
  updatedAt         DateTime     @updatedAt
  lastLoginAt       DateTime?
}

enum UserRole {
  ADMIN
  EDITOR  
  USER
}
```

## Возможные улучшения

- Восстановление пароля по email
- Активация 2FA (код уже готов)
- Email верификация
- Управление сессиями
- Аудит логи действий пользователей