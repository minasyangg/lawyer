# Чек-лист тестирования FileManager после рефакторинга

## Внесенные изменения
1. ✅ Удалены неиспользуемые API роуты:
   - `/api/filemanager/files/*`
   - `/api/filemanager/folders/*` 
   - `/api/filemanager/rename-folder/*`
   - `/api/upload/*`

2. ✅ RenameFolderModal переведен на Server Action
3. ✅ FileManagerPage обновлен для поддержки множественной загрузки файлов
4. ✅ Обновлен middleware.ts для удаления ссылок на удаленные API

## Функциональность для тестирования

### 1. Основные функции FileManagerPage
- [ ] Открытие страницы `/admin/filemanager`
- [ ] Загрузка списка файлов и папок
- [ ] Загрузка одного файла
- [ ] Загрузка нескольких файлов одновременно
- [ ] Создание новой папки
- [ ] Переименование папки
- [ ] Удаление файла
- [ ] Удаление папки
- [ ] Навигация по папкам
- [ ] Поиск файлов
- [ ] Переключение между Grid/List view
- [ ] Пагинация

### 2. Модальная версия FileManager
- [ ] Открытие файлового менеджера в модальном окне
- [ ] Выбор файла для вставки в редактор
- [ ] Загрузка файлов через модальное окно
- [ ] Создание папки в модальном окне
- [ ] Навигация по папкам в модальном окне

### 3. Переименование папок (RenameFolderModal)
- [ ] Открытие диалога переименования
- [ ] Валидация названия папки
- [ ] Успешное переименование папки
- [ ] Обработка ошибок при переименовании

### 4. Работа с защищенными файлами
- [ ] Доступ к файлам по виртуальному ID
- [ ] Проверка прав доступа к файлам
- [ ] Отображение индикатора использования файлов в статьях

### 5. Интеграция с редактором
- [ ] Загрузка файлов через RichTextEditor
- [ ] Вставка изображений в статьи
- [ ] Работа с документами в статьях

## Проверка API роутов

### Должны работать:
- [ ] `GET /api/files/[id]` - доступ к файлам по ID
- [ ] `GET /api/files/virtual/[virtualId]` - доступ к файлам по виртуальному ID
- [ ] API для работы с тегами и статьями (не изменялись)

### Должны возвращать 404:
- [ ] `GET /api/filemanager/files` - должен вернуть 404
- [ ] `POST /api/filemanager/files` - должен вернуть 404  
- [ ] `POST /api/upload` - должен вернуть 404
- [ ] `POST /api/filemanager/rename-folder` - должен вернуть 404

## Инструкции для тестирования

1. **Откройте проект в браузере**: http://localhost:3000
2. **Войдите как администратор**
3. **Перейдите в админ-панель**: `/admin`
4. **Откройте файловый менеджер**: `/admin/filemanager`

### Тест 1: Основная функциональность
1. Проверьте загрузку страницы файлового менеджера
2. Попробуйте загрузить один файл
3. Попробуйте загрузить несколько файлов одновременно
4. Создайте новую папку
5. Переименуйте созданную папку
6. Удалите тестовые файлы

### Тест 2: Модальная версия
1. Перейдите в редактор статей
2. Откройте файловый менеджер в модальном окне
3. Попробуйте загрузить файл через модальное окно
4. Выберите файл для вставки в статью

### Тест 3: Проверка удаленных API
Откройте консоль разработчика и проверьте следующие URL:
- `GET /api/filemanager/files` → должен вернуть 404
- `POST /api/upload` → должен вернуть 404

## Ожидаемые результаты
- ✅ Все функции работают как раньше
- ✅ Загрузка файлов теперь поддерживает множественный выбор
- ✅ Переименование папок работает без изменений в UX
- ✅ Удаленные API больше не доступны
- ✅ Производительность не ухудшилась
- ✅ Нет ошибок в консоли браузера

## Возможные проблемы
Если что-то не работает, проверьте:
1. Логи в консоли браузера
2. Логи в терминале где запущен Next.js
3. Network tab в DevTools для неудачных запросов
4. Правильность импортов Server Actions